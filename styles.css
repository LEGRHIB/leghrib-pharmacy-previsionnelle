:root {
  --bg:#0f172a;--bg2:#1e293b;--bg3:#334155;--bg4:#475569;
  --text:#f1f5f9;--text2:#94a3b8;--text3:#64748b;
  --accent:#3b82f6;--accent2:#2563eb;
  --red:#ef4444;--orange:#f97316;--yellow:#eab308;--green:#22c55e;--blue:#3b82f6;--purple:#a855f7;--cyan:#06b6d4;
  --red-bg:rgba(239,68,68,.15);--orange-bg:rgba(249,115,22,.15);--yellow-bg:rgba(234,179,8,.12);
  --green-bg:rgba(34,197,94,.12);--blue-bg:rgba(59,130,246,.12);--purple-bg:rgba(168,85,247,.12);--cyan-bg:rgba(6,182,212,.12);
  --radius:8px;--shadow:0 4px 24px rgba(0,0,0,.3);
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Poppins','Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
a{color:var(--accent);text-decoration:none}
.app{display:flex;min-height:100vh}
.sidebar{width:240px;background:var(--bg2);border-right:1px solid var(--bg3);padding:16px 0;display:flex;flex-direction:column;position:fixed;height:100vh;z-index:100}
.sidebar-header{padding:14px 16px;border-bottom:1px solid var(--bg3);margin-bottom:8px}
.sidebar-logo{display:flex;align-items:center;gap:10px;margin-bottom:6px}
.sidebar-logo svg{flex-shrink:0}
.sidebar-brand{display:flex;flex-direction:column;line-height:1.2}
.sidebar-brand .brand-name{font-size:16px;font-weight:700;color:#f0faf7;letter-spacing:.3px}
.sidebar-brand .brand-sub{font-size:9px;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:#5FBCA7;margin-top:1px}
.sidebar-header p{font-size:10px;color:var(--text3);margin-top:4px;letter-spacing:.3px}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 20px;cursor:pointer;transition:all .2s;color:var(--text2);font-size:14px;border-left:3px solid transparent}
.nav-item:hover{background:var(--bg3);color:var(--text)}
.nav-item.active{background:rgba(59,130,246,.1);color:var(--accent);border-left-color:var(--accent)}
.nav-item .badge{margin-left:auto;background:var(--red);color:#fff;font-size:10px;padding:2px 6px;border-radius:10px;font-weight:600}
.nav-icon{width:18px;text-align:center;font-size:15px}
.main{margin-left:240px;flex:1;padding:24px;max-width:calc(100vw - 240px)}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-bottom:24px}
.card{background:var(--bg2);border:1px solid var(--bg3);border-radius:var(--radius);padding:16px}
.card-label{font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}
.card-value{font-size:28px;font-weight:700}
.card-sub{font-size:11px;color:var(--text3);margin-top:4px}
.card.red .card-value{color:var(--red)}.card.orange .card-value{color:var(--orange)}.card.yellow .card-value{color:var(--yellow)}.card.green .card-value{color:var(--green)}.card.blue .card-value{color:var(--blue)}.card.purple .card-value{color:var(--purple)}.card.cyan .card-value{color:var(--cyan)}
.table-wrap{background:var(--bg2);border:1px solid var(--bg3);border-radius:var(--radius);overflow:hidden}
.table-toolbar{display:flex;gap:8px;padding:12px 16px;border-bottom:1px solid var(--bg3);flex-wrap:wrap;align-items:center}
.table-toolbar input,.table-toolbar select{background:var(--bg);border:1px solid var(--bg3);color:var(--text);padding:6px 10px;border-radius:6px;font-size:13px;outline:none}
.table-toolbar input:focus,.table-toolbar select:focus{border-color:var(--accent)}
.table-toolbar input{width:260px}
.table-toolbar select{min-width:120px}
.btn{padding:6px 14px;border-radius:6px;border:none;cursor:pointer;font-size:13px;font-weight:500;transition:all .15s;display:inline-flex;align-items:center;gap:6px}
.btn-primary{background:var(--accent);color:#fff}.btn-primary:hover{background:var(--accent2)}
.btn-secondary{background:var(--bg3);color:var(--text)}.btn-secondary:hover{background:var(--bg4)}
table{width:100%;border-collapse:collapse;font-size:13px}
thead th{background:var(--bg);padding:8px 12px;text-align:left;font-weight:600;font-size:11px;text-transform:uppercase;letter-spacing:.3px;color:var(--text3);position:sticky;top:0;cursor:pointer;white-space:nowrap;user-select:none}
thead th:hover{color:var(--text)}
thead th .sort-arrow{margin-left:4px;font-size:10px}
tbody tr{border-bottom:1px solid var(--bg3);transition:background .1s}
tbody tr:hover{background:rgba(255,255,255,.03)}
tbody td{padding:7px 12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:300px}
.table-scroll{max-height:calc(100vh - 340px);overflow-y:auto}
.alert-badge{padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600;display:inline-block}
.alert-rupture{background:var(--red-bg);color:var(--red)}
.alert-5j{background:var(--orange-bg);color:var(--orange)}
.alert-15j{background:var(--yellow-bg);color:var(--yellow)}
.alert-ok{background:var(--green-bg);color:var(--green)}
.alert-surstock{background:var(--blue-bg);color:var(--blue)}
.alert-withdrawn{background:rgba(100,116,139,.2);color:#94a3b8;text-decoration:line-through}
.alert-dci{background:var(--cyan-bg);color:var(--cyan)}
.abc-badge{padding:1px 6px;border-radius:3px;font-size:10px;font-weight:700;margin-right:4px}
.abc-A{background:rgba(239,68,68,.2);color:var(--red)}.abc-B{background:rgba(249,115,22,.2);color:var(--orange)}.abc-C{background:rgba(100,116,139,.2);color:var(--text3)}
.xyz-X{border:1px solid var(--green)}.xyz-Y{border:1px solid var(--yellow)}.xyz-Z{border:1px solid var(--red)}
.charts-row{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:24px}
.chart-box{background:var(--bg2);border:1px solid var(--bg3);border-radius:var(--radius);padding:16px}
.chart-box h3{font-size:14px;margin-bottom:12px;color:var(--text2)}
.chart-box canvas{max-height:260px}
.import-zone{border:2px dashed var(--bg3);border-radius:var(--radius);padding:48px 40px;text-align:center;cursor:pointer;transition:all .2s;background:var(--bg2);margin-bottom:16px}
.import-zone:hover,.import-zone.dragover{border-color:var(--accent);background:rgba(59,130,246,.05)}
.import-zone h3{font-size:18px;margin-bottom:8px}
.import-zone p{font-size:13px;color:var(--text3)}
.import-icon{font-size:48px;margin-bottom:12px}
.import-status-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:16px}
.import-status{display:flex;align-items:center;gap:8px;padding:12px 16px;background:var(--bg2);border:1px solid var(--bg3);border-radius:var(--radius);font-size:13px}
.import-status .dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.dot-green{background:var(--green)}.dot-red{background:var(--red)}.dot-gray{background:var(--text3)}
.settings-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.setting-group{background:var(--bg2);border:1px solid var(--bg3);border-radius:var(--radius);padding:20px}
.setting-group h3{font-size:15px;margin-bottom:16px;padding-bottom:8px;border-bottom:1px solid var(--bg3)}
.setting-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0}
.setting-row label{font-size:13px;color:var(--text2)}
.setting-row input,.setting-row select{background:var(--bg);border:1px solid var(--bg3);color:var(--text);padding:6px 10px;border-radius:6px;font-size:13px;width:120px;text-align:right}
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:200;display:none;justify-content:center;align-items:flex-start;padding:40px;overflow-y:auto}
.modal-overlay.show{display:flex}
.modal{background:var(--bg2);border:1px solid var(--bg3);border-radius:12px;width:100%;max-width:950px;padding:24px;box-shadow:var(--shadow)}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.modal-header h2{font-size:18px}
.modal-close{background:none;border:none;color:var(--text3);font-size:24px;cursor:pointer}
.modal-close:hover{color:var(--text)}
.detail-grid{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:12px}
.detail-stat{padding:12px;background:var(--bg);border-radius:6px}
.detail-stat .label{font-size:11px;color:var(--text3)}
.detail-stat .value{font-size:18px;font-weight:600;margin-top:2px}
.tabs{display:flex;gap:4px;margin-bottom:16px}
.tab{padding:8px 16px;border-radius:6px;font-size:13px;cursor:pointer;background:var(--bg);color:var(--text3);border:1px solid var(--bg3);transition:all .15s}
.tab.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.tab:hover:not(.active){background:var(--bg3);color:var(--text)}
.supplier-row{display:flex;align-items:center;gap:12px;padding:8px 12px;border-radius:6px;margin-bottom:4px;border:1px solid var(--bg3)}
.supplier-row.best{background:rgba(34,197,94,.08);border-color:rgba(34,197,94,.3)}
.supplier-row.second{background:rgba(59,130,246,.06);border-color:rgba(59,130,246,.2)}
.supplier-price{font-weight:600;font-size:15px;min-width:90px}
.supplier-name{font-size:13px;color:var(--text2);flex:1}
.supplier-date{font-size:11px;color:var(--text3);min-width:80px}
.risk-bar{width:60px;height:6px;background:var(--bg3);border-radius:3px;display:inline-block;vertical-align:middle;margin-right:6px}
.risk-fill{height:100%;border-radius:3px}
.page-title{font-size:22px;font-weight:700;margin-bottom:4px}
.page-subtitle{font-size:13px;color:var(--text3);margin-bottom:20px}
.export-bar{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:var(--bg2);border:1px solid var(--bg3);border-radius:var(--radius);margin-bottom:16px}
.export-summary{font-size:14px}.export-summary strong{color:var(--accent)}
.hidden-input{display:none}
.dci-group-badge{padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600;display:inline-block}
.dci-covered{background:var(--cyan-bg);color:var(--cyan)}
.dci-partial{background:var(--yellow-bg);color:var(--yellow)}
.dci-alone{background:rgba(100,116,139,.15);color:var(--text3)}
.price-best{color:var(--green);font-weight:600}
.price-second{color:var(--blue);font-weight:500}
.price-old{opacity:.6;font-style:italic}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid var(--bg3);border-top-color:var(--accent);border-radius:50%;animation:spin .6s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.pagination{display:flex;justify-content:center;align-items:center;gap:4px;padding:12px}
.pagination button{background:var(--bg);border:1px solid var(--bg3);color:var(--text2);padding:4px 10px;border-radius:4px;cursor:pointer;font-size:12px}
.pagination button.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.pagination button:hover:not(.active):not(:disabled){background:var(--bg3)}
.pagination button:disabled{opacity:.3;cursor:default}
.pagination .page-info{font-size:12px;color:var(--text3);margin:0 8px}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:3px}
@media(max-width:1200px){.charts-row,.settings-grid,.detail-grid{grid-template-columns:1fr 1fr}.import-status-grid{grid-template-columns:1fr}}
@media(max-width:768px){.sidebar{display:none}.main{margin-left:0}}
.dci-match-row{display:flex;align-items:center;gap:8px;padding:6px 0}
.dci-match-row input{background:var(--bg);border:1px solid var(--bg3);color:var(--text);padding:4px 8px;border-radius:4px;font-size:12px;width:140px}
.dci-match-row input:focus{border-color:var(--accent)}
.dci-confidence{padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600}
.dci-exact{background:var(--green-bg);color:var(--green)}
.dci-approx{background:var(--orange-bg);color:var(--orange)}
.dci-none{background:var(--red-bg);color:var(--red)}
.dci-manual{background:var(--purple-bg);color:var(--purple)}
.badge-orange{background:var(--orange);color:#fff;font-size:10px;padding:2px 6px;border-radius:10px;font-weight:600}
/* V4.1: DCI/Category Autocomplete Dropdown */
.dci-autocomplete{position:relative;display:inline-block;width:140px}
.dci-input{background:var(--bg);border:1px solid var(--bg3);color:var(--text);padding:3px 6px;border-radius:4px;font-size:11px;width:100%;outline:none;transition:all .15s}
.dci-input:focus{border-color:var(--accent);box-shadow:0 0 0 2px rgba(59,130,246,.1)}
.dci-dropdown{display:none;position:absolute;top:100%;left:0;right:0;background:var(--bg2);border:1px solid var(--bg3);border-top:none;border-radius:0 0 4px 4px;max-height:200px;overflow-y:auto;z-index:1000;box-shadow:0 4px 12px rgba(0,0,0,.3)}
.dci-dropdown-item{padding:6px 10px;cursor:pointer;border-bottom:1px solid var(--bg3);font-size:11px;color:var(--text);transition:background .1s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.dci-dropdown-item:hover{background:var(--bg3);color:var(--accent)}
.dci-dropdown-item:last-child{border-bottom:none}
.dci-dropdown::-webkit-scrollbar{width:5px}.dci-dropdown::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:3px}
.cat-badge{padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600;background:var(--cyan-bg);color:var(--cyan)}
